<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Princess Magdalena's Royal Quest 👑</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Cinzel:wght@400;500;600;700&family=Cormorant+Garamond:wght@400;500;600;700&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <style>
        :root {
            --royal-gold: #FFD700;
            --deep-gold: #B8860B;
            --rich-gold: #DAA520;
            --pale-gold: #F5DEB3;
            --dark-gold: #8B7500;
            --midnight: #1A1A2E;
            --royal-black: #0F0F1A;
            --gold-glow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Playfair Display', serif;
            background: radial-gradient(circle at center, var(--midnight) 0%, var(--royal-black) 100%);
            background-attachment: fixed;
            overflow-x: hidden;
            color: var(--royal-gold);
            min-height: 100vh;
        }

        .page {
            display: none;
            min-height: 100vh;
            padding: 15px;
            position: relative;
            animation: pageSlideIn 0.6s ease-out;
        }

        .page.active {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        @keyframes pageSlideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .story-container, .game-container {
            max-width: 90vw;
            width: 100%;
            max-width: 800px;
            text-align: center;
            background: linear-gradient(145deg, rgba(218, 165, 32, 0.15), rgba(184, 134, 11, 0.1));
            backdrop-filter: blur(15px);
            border: 3px solid var(--royal-gold);
            border-radius: 20px;
            padding: 30px 20px;
            box-shadow: var(--gold-glow), inset 0 0 30px rgba(255, 215, 0, 0.1);
            margin: 10px;
        }

        .title {
            font-family: 'Cinzel', serif;
            font-size: clamp(2rem, 8vw, 3.5rem);
            color: var(--royal-gold);
            margin-bottom: 15px;
            text-shadow: var(--gold-glow);
            font-weight: 700;
        }

        .subtitle {
            font-family: 'Cormorant Garamond', serif;
            font-size: clamp(1.1rem, 4vw, 1.4rem);
            color: var(--pale-gold);
            margin-bottom: 20px;
            font-weight: 600;
        }

        .story-text {
            font-family: 'Crimson Text', serif;
            font-size: clamp(1rem, 3vw, 1.2rem);
            line-height: 1.6;
            margin-bottom: 25px;
            color: var(--pale-gold);
        }

        .btn, .retro-button {
            background: linear-gradient(145deg, var(--royal-gold), var(--deep-gold));
            color: var(--royal-black);
            border: 2px solid var(--dark-gold);
            padding: 12px 25px;
            border-radius: 15px;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            font-family: 'Cinzel', serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 8px;
            box-shadow: var(--gold-glow);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover, .retro-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
            background: linear-gradient(145deg, #FFE55C, var(--royal-gold));
        }

        /* Memory Game - Fast & Elegant */
        .memory-palace-container {
            background: linear-gradient(145deg, rgba(255, 215, 0, 0.2), rgba(184, 134, 11, 0.15));
            border: 3px solid var(--royal-gold);
            border-radius: 15px;
            padding: 25px;
            margin: 20px auto;
            max-width: 450px;
            box-shadow: var(--gold-glow);
        }

        .memory-palace-header {
            background: linear-gradient(90deg, var(--deep-gold), var(--royal-gold));
            color: var(--royal-black);
            padding: 12px;
            margin: -25px -25px 20px -25px;
            border-radius: 12px 12px 0 0;
            font-family: 'Cinzel', serif;
            font-weight: 700;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .pattern-stats-panel {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.8), rgba(15, 15, 26, 0.9));
            border: 2px solid var(--dark-gold);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        .stat-display {
            background: var(--royal-black);
            color: var(--royal-gold);
            border: 2px solid var(--dark-gold);
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            font-weight: bold;
            text-shadow: 0 0 5px var(--royal-gold);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--pale-gold);
            display: block;
            margin-bottom: 3px;
        }

        .pattern-challenge {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 20px auto;
            max-width: 280px;
            background: var(--royal-black);
            padding: 20px;
            border: 3px solid var(--dark-gold);
            border-radius: 12px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .pattern-tile {
            aspect-ratio: 1;
            background: linear-gradient(145deg, var(--deep-gold), var(--royal-gold));
            border: 2px solid var(--dark-gold);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.4rem, 5vw, 2rem);
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--royal-black);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            user-select: none;
        }

        .pattern-tile:hover {
            background: linear-gradient(145deg, #FFE55C, #FFD700);
            transform: translateY(-2px);
            box-shadow: var(--gold-glow);
        }

        .pattern-tile.highlight {
            background: linear-gradient(145deg, #FFFF99, #FFE55C);
            animation: golden-glow 0.6s ease;
            box-shadow: 0 0 25px var(--royal-gold);
        }

        .pattern-tile.correct {
            background: linear-gradient(145deg, #98FB98, #32CD32);
            animation: success-bounce 0.4s ease;
        }

        .pattern-tile.wrong {
            background: linear-gradient(145deg, #FFB6C1, #DC143C);
            animation: error-shake 0.4s ease;
        }

        @keyframes golden-glow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); box-shadow: 0 0 30px var(--royal-gold); }
        }

        @keyframes success-bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @keyframes error-shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .game-message {
            background: linear-gradient(145deg, rgba(255, 215, 0, 0.2), rgba(218, 165, 32, 0.15));
            border: 2px solid var(--royal-gold);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Crimson Text', serif;
            font-size: 1.1rem;
            color: var(--royal-gold);
            text-align: center;
            box-shadow: var(--gold-glow);
        }

        /* Enhanced Tower Game */
        .tower-fortress {
            position: relative;
            width: min(350px, 90vw);
            height: 450px;
            margin: 20px auto;
            background: linear-gradient(180deg, #8B7355 0%, #654321 50%, #2C1810 100%);
            border-radius: 15px;
            border: 4px solid var(--royal-gold);
            overflow: hidden;
            box-shadow: var(--gold-glow);
        }

        .tower-level {
            position: absolute;
            width: 100%;
            height: 80px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: space-around;
        }

        .princess-warrior {
            position: absolute;
            bottom: 15px;
            left: 20px;
            font-size: 2.2rem;
            transition: all 0.3s ease;
            z-index: 5;
            filter: drop-shadow(0 0 8px var(--royal-gold));
            pointer-events: none;
        }

        .tower-enemy {
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, #DC143C, #8B0000);
            border: 2px solid var(--royal-gold);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.2rem;
            animation: enemy-threat 1.5s ease-in-out infinite;
            z-index: 15;
            position: relative;
        }

        @keyframes enemy-threat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); box-shadow: 0 0 10px #DC143C; }
        }

        .tower-enemy:hover {
            background: var(--royal-gold);
            color: var(--royal-black);
            transform: scale(1.2);
        }

        .tower-enemy.defeated {
            opacity: 0.2;
            pointer-events: none;
            background: #32CD32;
            animation: none;
        }

        /* Enhanced Dragon Battle */
        .dragon-battlefield {
            position: relative;
            width: min(100%, 700px);
            height: 400px;
            margin: 20px auto;
            background: radial-gradient(circle at center, var(--midnight) 0%, var(--royal-black) 100%);
            border-radius: 20px;
            border: 4px solid var(--royal-gold);
            overflow: hidden;
            box-shadow: var(--gold-glow);
        }

        .dragon-boss {
            position: absolute;
            font-size: clamp(2.5rem, 8vw, 4rem);
            z-index: 5;
            filter: drop-shadow(0 0 10px #DC2626);
            transition: all 0.3s ease;
        }

        .dragon-boss.damaged {
            animation: dragon-hurt 0.4s ease;
        }

        @keyframes dragon-hurt {
            0%, 100% { transform: scale(1) rotate(0deg); filter: drop-shadow(0 0 10px #DC2626); }
            50% { transform: scale(1.1) rotate(-5deg); filter: drop-shadow(0 0 20px #FF0000); }
        }

        .dragon-boss.phase1 { animation: dragon-fly1 3s linear infinite; }
        .dragon-boss.phase2 { animation: dragon-fly2 2.5s linear infinite; }
        .dragon-boss.phase3 { animation: dragon-fly3 2s linear infinite; }

        @keyframes dragon-fly1 {
            0% { left: -100px; top: 20%; }
            100% { left: 100%; top: 20%; }
        }

        @keyframes dragon-fly2 {
            0% { left: 100%; top: 10%; }
            50% { left: 50%; top: 40%; }
            100% { left: -100px; top: 10%; }
        }

        @keyframes dragon-fly3 {
            0% { left: -100px; top: 5%; }
            25% { left: 30%; top: 50%; }
            50% { left: 70%; top: 15%; }
            75% { left: 40%; top: 5%; }
            100% { left: 100%; top: 30%; }
        }

        .princess-archer {
            position: absolute;
            bottom: 20px;
            left: 50px;
            font-size: clamp(2rem, 6vw, 2.8rem);
            cursor: pointer;
            transition: all 0.3s ease;
            filter: drop-shadow(0 0 8px var(--royal-gold));
        }

        .princess-archer:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 15px var(--royal-gold));
        }

        .princess-archer.hit {
            animation: princess-hit 0.5s ease;
        }

        @keyframes princess-hit {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 8px var(--royal-gold)); }
            50% { transform: scale(0.9); filter: drop-shadow(0 0 15px #DC2626); }
        }

        .magic-arrow {
            position: absolute;
            font-size: clamp(1rem, 4vw, 1.5rem);
            color: var(--royal-gold);
            z-index: 8;
            filter: drop-shadow(0 0 5px var(--royal-gold));
        }

        .dragon-fire {
            position: absolute;
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            z-index: 6;
            animation: fireball-attack 2s linear;
        }

        @keyframes fireball-attack {
            0% { right: -50px; top: 20%; opacity: 1; transform: scale(1); }
            100% { right: 90%; top: 60%; opacity: 0; transform: scale(1.5); }
        }

        .combat-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
            font-family: 'Cinzel', serif;
        }

        .stat-box {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.8), rgba(15, 15, 26, 0.9));
            padding: 12px;
            border-radius: 10px;
            border: 2px solid var(--royal-gold);
            color: var(--royal-gold);
        }

        /* Dancing Scene */
        .dance-container {
            width: 100%;
            height: 100vh;
            overflow: hidden;
            position: relative;
            background: var(--royal-black);
        }

        #couple {
            max-height: 100%;
            width: 100%;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.3));
        }

        .celebration-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 100;
            pointer-events: none;
        }

        .victory-title {
            font-family: 'Cinzel', serif;
            font-size: clamp(2rem, 8vw, 4rem);
            color: var(--royal-gold);
            text-shadow: var(--gold-glow);
            margin-bottom: 20px;
            animation: title-glow 2s ease-in-out infinite;
        }

        @keyframes title-glow {
            0%, 100% { opacity: 0.9; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        /* UI Controls */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--royal-gold), var(--deep-gold));
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--royal-gold);
        }

        .music-controls {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(26, 26, 46, 0.9);
            border-radius: 12px;
            padding: 10px;
            border: 2px solid var(--royal-gold);
            z-index: 1500;
            backdrop-filter: blur(10px);
        }

        .music-btn {
            background: var(--royal-gold);
            color: var(--royal-black);
            border: none;
            border-radius: 8px;
            width: 35px;
            height: 35px;
            margin: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .music-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 10px var(--royal-gold);
        }

        .game-timer {
            position: fixed;
            top: 15px;
            left: 15px;
            background: rgba(26, 26, 46, 0.9);
            border-radius: 12px;
            padding: 12px 18px;
            border: 2px solid var(--royal-gold);
            font-family: 'Cinzel', serif;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            color: var(--royal-gold);
            font-weight: 600;
            z-index: 2000;
            backdrop-filter: blur(10px);
            box-shadow: var(--gold-glow);
        }

        .hearts-effect {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
        }

        .floating-heart {
            position: absolute;
            font-size: 1.5rem;
            animation: heart-float 3s ease-out forwards;
            color: var(--royal-gold);
        }

        @keyframes heart-float {
            0% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
            100% { opacity: 0; transform: translateY(-120px) scale(1.5) rotate(360deg); }
        }

        /* SVG Styles */
        .st0{fill:#F8E5C5;}
        .st1{fill:#F0B38A;}
        .st2{fill:#660000;}
        .st3{fill:#161C1D;}
        .st4{fill:#EB1D23;}

        #girl-hair { fill: url(#hair-gradient); }
        #girl-eye { fill: #10B981; }
        #girl-earring { fill: #8d8d8d; }
        #girl-skirt, #girl-shirt { fill: #791e43; }
        #boy-pants { fill: #848487; }
        #boy-sleeve { fill: #b8bcbb; }
        #boy-shirt { fill: #256e89; }
        #boy-hat-1 { fill: #2e6773; }
        #boy-hat-2 { fill: #4f3723; }
        #couple, #heart, #triangle-light { visibility: hidden; }
        #triangle-light { fill: url(#light-gradient); fill-opacity: 0.3; }
        #ground { fill: #5c5757; }

        @media (max-width: 768px) {
            .page { padding: 10px; }
            .story-container, .game-container { padding: 20px 15px; }
            .pattern-challenge { max-width: 260px; }
            .tower-fortress { width: 95vw; height: 400px; }
            .dragon-battlefield { height: 320px; }
        }
    </style>
</head>
<body>
    <!-- Music Controls -->
    <div class="music-controls">
        <button class="music-btn" onclick="toggleMusic()" id="musicBtn">▶</button>
        <button class="music-btn" onclick="nextSong()">⏭</button>
    </div>

    <!-- Game Timer -->
    <div class="game-timer">
        ⏱ <span id="timer">00:00</span>
    </div>

    <!-- Progress Bar -->
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- Page 1: Epic Introduction -->
    <div class="page active" id="page1">
        <div class="story-container">
            <h1 class="title">Princess Magdalena's Royal Quest</h1>
            <p class="subtitle">An Epic Tale of Courage, Magic & Heroism ⚔️</p>
            <div class="story-text">
                In the mystical Kingdom of Eldoria, Princess Magdalena was renowned for her courage and magical prowess. 
                When the evil sorceress Ravenna captures Prince Flynn and imprisons him in the dreaded Tower of Shadows, 
                the brave princess refuses to wait for rescue!
                <br><br>
                Armed with her ancestral magic and indomitable spirit, she embarks on a perilous quest. 
                Three legendary challenges await - each testing her mind, courage, and skill.
                <br><br>
                <strong>"By the crown of my ancestors, I shall rescue him myself!"</strong>
            </div>
            <button class="btn" onclick="nextPage()">
                ⚔️ BEGIN THE QUEST
            </button>
        </div>
    </div>

    <!-- Page 2: Memory Palace Challenge -->
    <div class="page" id="page2">
        <div class="game-container">
            <h2 class="title">The Memory Palace of Ancients</h2>
            <p class="subtitle">Master the Sacred Royal Patterns 🔮</p>
            <div class="story-text">
                The ancient Memory Palace guards the castle gates with mystical patterns. Princess Magdalena 
                must memorize the glowing sequence of royal symbols to unlock the way forward!
                <br><br>
                <strong>Watch the golden glow, then click the symbols in the same order!</strong>
            </div>
            
            <div class="memory-palace-container">
                <div class="memory-palace-header">
                    ✨ ROYAL MEMORY PALACE ✨
                </div>
                
                <div class="pattern-stats-panel">
                    <div class="stat-display">
                        <span class="stat-label">LEVEL</span>
                        <span id="patternLevel">1</span>/3
                    </div>
                    <div class="stat-display">
                        <span class="stat-label">LIVES</span>
                        <span id="patternLives">5</span> ❤️
                    </div>
                    <div class="stat-display">
                        <span class="stat-label">SEQUENCE</span>
                        <span id="sequenceLength">3</span>
                    </div>
                </div>
                
                <div class="pattern-challenge" id="patternGrid">
                    <!-- Symbols will be generated dynamically -->
                </div>
                
                <div id="patternResult"></div>
                
                <button class="retro-button" onclick="startPatternGame()" id="patternStartBtn">
                    🧠 ACTIVATE MEMORY PALACE
                </button>
            </div>
        </div>
    </div>

    <!-- Page 3: Tower Siege -->
    <div class="page" id="page3">
        <div class="game-container">
            <h2 class="title">The Siege of Shadow Tower</h2>
            <p class="subtitle">Conquer Three Floors of Enemies 🏰</p>
            <div class="story-text">
                The Tower of Shadows has three heavily guarded levels. Princess Magdalena must clear each floor 
                of enemies before advancing. Click quickly - enemies will multiply if left alone!
                <br><br>
                <strong>Click all enemies on each floor to advance!</strong>
            </div>
            
            <div class="tower-fortress" id="towerFortress">
                <div class="princess-warrior" id="princessWarrior">👸⚔️</div>
                <!-- Levels and enemies will be generated dynamically -->
            </div>
            
            <div class="pattern-stats-panel">
                <div class="stat-display">
                    <span class="stat-label">FLOOR</span>
                    <span id="currentFloor">1</span>/3
                </div>
                <div class="stat-display">
                    <span class="stat-label">ENEMIES</span>
                    <span id="enemiesLeft">0</span>
                </div>
                <div class="stat-display">
                    <span class="stat-label">TIME</span>
                    <span id="floorTimer">30</span>s
                </div>
            </div>
            
            <div id="towerResult"></div>
        </div>
    </div>

    <!-- Page 4: Dragon Boss Battle -->
    <div class="page" id="page4">
        <div class="game-container">
            <h2 class="title">The Ancient Dragon Sovereign</h2>
            <p class="subtitle">Epic Boss Battle - Avoid the Fire! 🐉</p>
            <div class="story-text">
                Draconus the Ancient guards Prince Flynn's prison. This legendary dragon breathes fire and 
                attacks relentlessly. Princess Magdalena must defeat it while dodging fireballs!
                <br><br>
                <strong>Click the princess to shoot arrows. Avoid the dragon's fire attacks!</strong>
            </div>
            
            <div class="dragon-battlefield" id="dragonBattlefield">
                <div class="dragon-boss phase1" id="dragonBoss">🐉</div>
                <div class="princess-archer" onclick="shootMagicArrow()">🏹👸</div>
            </div>
            
            <div class="combat-stats">
                <div class="stat-box">
                    <div>Dragon Health: <span id="dragonHealth">5</span>/5 ❤️</div>
                    <div>Phase: <span id="dragonPhase">1</span>/3</div>
                </div>
                <div class="stat-box">
                    <div>Princess Health: <span id="princessHealth">5</span>/5 💖</div>
                    <div>Hits: <span id="arrowHits">0</span> 🎯</div>
                </div>
            </div>
            
            <div id="dragonResult"></div>
        </div>
    </div>

    <!-- Page 5: Heroic Rescue -->
    <div class="page" id="page5">
        <div class="story-container">
            <h1 class="title">The Heroic Rescue!</h1>
            <p class="subtitle">Princess Magdalena Triumphs! 👑</p>
            <div class="story-text">
                Through skill, courage, and magical prowess, Princess Magdalena has conquered every challenge! 
                She bursts through the tower's door to find Prince Flynn.
                <br><br>
                <strong>"My hero!"</strong> gasps the prince in wonder.
                <br><br>
                <strong>"A true princess saves herself... and those she loves!"</strong> 
                declares Magdalena with a smile.
                <br><br>
                Together they escape, and the kingdom celebrates their legendary princess!
            </div>
            <button class="btn" onclick="nextPage()">
                💃 ROYAL CELEBRATION!
            </button>
        </div>
    </div>

    <!-- Page 6: Dancing Scene -->
    <div class="page" id="page6">
        <div class="dance-container">
            <div class="celebration-overlay" id="celebrationText">
                <div class="victory-title">Legendary Victory!</div>
                <div class="subtitle">The Kingdom Celebrates Princess Magdalena!</div>
                <div style="margin-top: 20px; font-family: 'Cinzel', serif; color: var(--royal-gold);">
                    Quest Completed in: <span id="finalTime" style="color: var(--royal-gold);">00:00</span>
                </div>
            </div>
            
            <svg id="couple" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="150 100 900 900">
                <defs>
                    <linearGradient id="hair-gradient">
                        <stop offset="0%" stop-color="#5e3634" />
                        <stop offset="50%" stop-color="#dfc57b" />
                    </linearGradient>
                    <linearGradient id="light-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="10%" stop-color="rgb(120,175,120)" />
                        <stop offset="60%" stop-color="#1a2124" />
                    </linearGradient>
                </defs>
                <g>
                    <path id="heart" class="st0" d="M626.6,310.7c-20.1-35-58.8-12.9-70.8,4.6c-11.7-17.5-50.7-39.6-70.8-4.6
                        c-26.2,45.9,36.6,83.2,70.2,102c0.2,0,1,0.2,1.2,0C590.1,393.8,653,356.6,626.6,310.7L626.6,310.7z"/>
                    <path id="ground" class="st0" d="M604,886.9c-234.9,0-425,17-425,38.3c0,21.1,190.3,38.1,425,38.1c235,0,425.4-17,425.4-38.1
                        C1029.4,903.9,839.2,886.9,604,886.9L604,886.9z"/>
                    <g id="girl">
                        <g id="girl-leg-1">
                            <polygon class="st1" points="698.6,810.7 817.1,839.3 820,833 705.1,788.9"/>
                            <polygon class="st2" points="819.3,876.7 808.5,841.1 812.5,827 832.3,833"/>
                        </g>
                        <g id="girl-leg-2">
                            <polygon class="st1" points="690.8,801.3 713.6,921.1 720.5,921.1 713.2,798.3"/>
                            <polygon class="st2" points="679.9,931.5 711,910.9 725.5,910.9 725.5,931.5"/>
                        </g>
                        <g id="girl-body">
                            <path id="girl-shirt" class="st0" d="M638,572.4c0,0-47.6,31.5,24,117.4l41-12.3L667.3,588l-9.7-21.6L638,572.4z"/>
                            <path id="girl-skirt" class="st0" d="M667.3,666.5c-70.9,27.4-52.2,153.8-52.2,153.8s71.9,19.6,188.3-57
                                C803.4,763.2,748.3,635.2,667.3,666.5L667.3,666.5z"/>
                            <path id="girl-arm" class="st1" d="M609.1,652.2c0,0,42.7-48.8,49.7-42.7c7.3,6.5-38.6,52-38.6,52h-76.5L609.1,652.2z"/>
                            <g id="girl-head">
                                <path id="girl-face" class="st1" d="M695.4,509.5c-2-27.6-35.9-47.4-75.5-44.6c-39.6,3.1-70.1,27.7-68,55.1c2,27.6,35.7,47.5,75.3,44.6
                                    C667,561.7,697.4,537,695.4,509.5L695.4,509.5z"/>
                                <path id="girl-eye" class="st3" d="M579.7,507.6c-4.6,0.3-8,4.4-7.7,9c0.3,4.6,4.2,8.2,8.8,7.8c4.8-0.3,8.2-4.4,7.8-9
                                    C588.4,510.8,584.3,507.3,579.7,507.6L579.7,507.6z"/>
                                <path id="girl-hair" class="st3" d="M561.8,491.5c0,0,25.8,24.7,76.2,33.5c18.5,32.6,57.5,136.6,57.5,136.6
                                    s41.2,39.8,78.4-1.9c-11.2-4.4-47.4-6.3-61.4-44.4c-13.9-38.3,6.6-90-13.3-125.5c-11.6-20.9-35.4-44.2-75.7-39.4
                                    C591.8,453.9,576.1,468.7,561.8,491.5L561.8,491.5z"/>
                                <path id="girl-earring" class="st4" d="M646.9,525c0,4.8-3.9,8.7-8.8,8.7c-4.8,0-8.7-3.9-8.7-8.7s3.9-8.7,8.7-8.7C643,516.3,646.9,520.2,646.9,525
                                    L646.9,525z"/>
                            </g>
                            <polygon class="st1" points="635.2,561.5 642.6,577.5 659.8,569.5 651.1,550.6"/>
                        </g>
                    </g>
                    <g id="boy">
                        <polygon class="st2" points="481.6,901.5 498.9,901.5 500.8,901.5 500.6,903.2 532.6,925.5 480.4,925.5 480.4,901.5"/>
                        <rect x="474.8" y="565.8" class="st1" width="16.8" height="13.3"/>
                        <polygon class="st1" points="504.4,587.7 484.6,582.8 433.4,643.9 484.6,691.6 453.3,642.2"/>
                        <path class="st1" d="M478.7,461.9c-41.3,0-75,24-75,53.6c0,29.6,33.7,53.6,75,53.6c41.5,0,75.2-24,75.2-53.6
                            C553.9,485.8,520.2,461.9,478.7,461.9L478.7,461.9z"/>
                        <path id="boy-eye" class="st3" d="M534.1,503.4c-4.1,0-7.3,3.4-7.3,7.3c0,3.9,3.2,7.1,7.3,7.1c3.9,0,7.1-3.2,7.1-7.1
                            C541.3,506.8,538,503.4,534.1,503.4L534.1,503.4z"/>
                        <path class="st3" d="M526.8,473.1c0,0-3.2,30.4-57.8,46.6c0,10.5-0.8,48.1-0.8,48.1h-64.5c0,0-26.2-76,41.3-101.4
                            C463.4,461.9,489.6,454.9,526.8,473.1L526.8,473.1z"/>
                        <path id="boy-hat-2" class="st2" d="M379.9,516.6c7.1,12.6,44.9,4.9,81.8-16.3c34.2-20.4,52.7-45.9,43.7-58
                            c-8.7-11.9-40-6.5-72.5,13.4C397.9,476.3,373.1,504,379.9,516.6L379.9,516.6z"/>
                        <path id="boy-hat-1" class="st0" d="M471.2,443.3c-5.1-4.6-13.6-12.2-20.1-11.6c-11.7,1.4-28.2,10-28.2,10s-17.9,9.4-24.1,17.5
                            c-4.3,5.1-2.9,16.2-2.2,23c0.8,7,4.2,16.8,4.2,16.8c64.5-4.6,81.8-42.7,81.8-42.7S476.5,447.9,471.2,443.3L471.2,443.3z"/>
                        <polygon id="boy-pants" class="st0" points="461.5,704.9 481.6,901.5 498.9,901.5 523.2,704.9"/>
                        <polygon id="boy-shirt" class="st2" points="492.8,576 477.1,576 469.2,576 469.2,579 469.2,605.1 461.5,706.1 523.8,706.1 509.8,576 508.3,576"/>
                        <g id="boy-arm">
                            <polygon class="st1" points="474.6,598.3 514.7,662.4 602.3,667.3 519.8,645.9 490.1,581.6"/>
                            <polygon id="boy-sleeve" class="st0" points="469.2,594.9 489.7,626.2 513.9,610.3 493.3,579"/>
                        </g>
                        <path class="st1" d="M480.4,491.6c-6.3,0-11.6,9.7-11.6,21.4c0,11.9,5.3,21.6,11.6,21.6c6.5,0,11.6-9.7,11.6-21.6
                            C491.9,501.3,486.8,491.6,480.4,491.6L480.4,491.6z"/>
                    </g>
                </g>
                <polygon id="triangle-light" class="st5" points="1265.8,1383.2 542.5,0 0,1383.2"/>
            </svg>
            
            <button class="btn" onclick="restartGame()" style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 200; pointer-events: all;">
                🔄 PLAY AGAIN
            </button>
        </div>
    </div>

    <!-- Hearts Effect Container -->
    <div class="hearts-effect" id="heartsContainer"></div>

    <!-- Audio Elements -->
    <audio id="backgroundMusic" loop>
        <source src="./assets/audios/song1.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Game Variables
        let currentPage = 1;
        const totalPages = 6;
        let gameStartTime = Date.now();
        let musicPlaying = false;
        let currentSong = 0;
        const songs = ['./assets/audios/song1.mp3', './assets/audios/song2.mp3', './assets/audios/song3.mp3'];

        // Game 1: Memory Game Variables (Fast & Manageable)
        let currentLevel = 1;
        let patternLives = 5;
        let patternSequence = [];
        let playerSequence = [];
        let showingPattern = false;
        const maxLevel = 3;
        const symbols = ['👑', '⭐', '🔮', '💎', '🗝️', '⚔️', '🏰', '🌟', '✨'];

        // Game 2: Tower Variables (Fast)
        let currentFloor = 1;
        let enemiesRemaining = 0;
        let floorTimeLeft = 30;
        let floorTimer;
        const maxFloors = 3;

        // Game 3: Dragon Variables (Much Easier)
        let dragonHealth = 5;
        let dragonPhase = 1;
        let princessHealth = 5;
        let arrowHits = 0;
        let dragonAttackTimer;

        // Initialize Game
        document.addEventListener('DOMContentLoaded', function() {
            startTimer();
            updateProgress();
            createHeartEffect();
            initializePatternGrid();
        });

        function startTimer() {
            setInterval(() => {
                const elapsed = Date.now() - gameStartTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function toggleMusic() {
            const audio = document.getElementById('backgroundMusic');
            const btn = document.getElementById('musicBtn');
            
            if (musicPlaying) {
                audio.pause();
                btn.textContent = '▶';
                musicPlaying = false;
            } else {
                audio.play();
                btn.textContent = '⏸';
                musicPlaying = true;
            }
        }

        function nextSong() {
            const audio = document.getElementById('backgroundMusic');
            currentSong = (currentSong + 1) % songs.length;
            audio.src = songs[currentSong];
            if (musicPlaying) audio.play();
        }

        function nextPage() {
            if (currentPage < totalPages) {
                document.getElementById(`page${currentPage}`).classList.remove('active');
                currentPage++;
                document.getElementById(`page${currentPage}`).classList.add('active');
                updateProgress();
                
                if (currentPage === 3) setupTowerGame();
                if (currentPage === 4) setupDragonGame();
                if (currentPage === 6) startCelebrationAnimation();
                
                createHeartEffect();
            }
        }

        function updateProgress() {
            const progress = (currentPage / totalPages) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Game 1: Fast Memory Game
        function initializePatternGrid() {
            const grid = document.getElementById('patternGrid');
            grid.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const tile = document.createElement('div');
                tile.className = 'pattern-tile';
                tile.dataset.index = i;
                tile.textContent = symbols[i];
                tile.addEventListener('click', () => handlePatternClick(i));
                grid.appendChild(tile);
            }
        }

        function startPatternGame() {
            if (showingPattern) return;
            document.getElementById('patternStartBtn').style.display = 'none';
            generatePattern();
            showPattern();
        }

        function generatePattern() {
            patternSequence = [];
            const length = 2 + currentLevel; // Level 1: 3, Level 2: 4, Level 3: 5
            for (let i = 0; i < length; i++) {
                patternSequence.push(Math.floor(Math.random() * 9));
            }
            playerSequence = [];
            document.getElementById('sequenceLength').textContent = length;
        }

        function showPattern() {
            showingPattern = true;
            let index = 0;
            
            const showNext = () => {
                if (index < patternSequence.length) {
                    const tile = document.querySelector(`[data-index="${patternSequence[index]}"]`);
                    tile.classList.add('highlight');
                    
                    setTimeout(() => {
                        tile.classList.remove('highlight');
                        index++;
                        setTimeout(showNext, 400); // Fast pace
                    }, 600);
                } else {
                    showingPattern = false;
                    document.getElementById('patternResult').innerHTML = 
                        '<div class="game-message">✨ Now repeat the magical pattern! ✨</div>';
                }
            };
            
            setTimeout(showNext, 500);
        }

        function handlePatternClick(index) {
            if (showingPattern) return;
            
            playerSequence.push(index);
            const tile = document.querySelector(`[data-index="${index}"]`);
            
            if (index === patternSequence[playerSequence.length - 1]) {
                tile.classList.add('correct');
                setTimeout(() => tile.classList.remove('correct'), 300);
                
                if (playerSequence.length === patternSequence.length) {
                    currentLevel++;
                    if (currentLevel > maxLevel) {
                        document.getElementById('patternResult').innerHTML = `
                            <div class="game-message">
                                🎊 MEMORY PALACE MASTERED! 🎊
                                <br><button class="retro-button" onclick="nextPage()" style="margin-top: 15px;">
                                    ⚔️ STORM THE TOWER
                                </button>
                            </div>
                        `;
                    } else {
                        document.getElementById('patternLevel').textContent = currentLevel;
                        setTimeout(() => {
                            generatePattern();
                            showPattern();
                        }, 1500);
                    }
                }
            } else {
                tile.classList.add('wrong');
                setTimeout(() => tile.classList.remove('wrong'), 400);
                
                patternLives--;
                document.getElementById('patternLives').textContent = patternLives;
                
                if (patternLives <= 0) {
                    document.getElementById('patternResult').innerHTML = `
                        <div class="game-message">
                            Magic needs recharging! Try again, brave princess!
                            <br><button class="retro-button" onclick="resetPatternGame()" style="margin-top: 10px;">
                                🔄 TRY AGAIN
                            </button>
                        </div>
                    `;
                } else {
                    playerSequence = [];
                    setTimeout(() => showPattern(), 1000);
                }
            }
        }

        function resetPatternGame() {
            currentLevel = 1;
            patternLives = 5;
            document.getElementById('patternLevel').textContent = currentLevel;
            document.getElementById('patternLives').textContent = patternLives;
            document.getElementById('sequenceLength').textContent = '3';
            document.getElementById('patternResult').innerHTML = '';
            document.getElementById('patternStartBtn').style.display = 'inline-block';
        }

        // Game 2: Fast Tower Game
        function setupTowerGame() {
            currentFloor = 1;
            floorTimeLeft = 30;
            setupFloor();
            startFloorTimer();
        }

        function setupFloor() {
            const tower = document.getElementById('towerFortress');
            tower.querySelectorAll('.tower-enemy, .tower-level').forEach(el => {
                if (!el.classList.contains('princess-warrior')) el.remove();
            });
            
            // Create current floor
            const level = document.createElement('div');
            level.className = 'tower-level';
            level.style.bottom = ((currentFloor - 1) * 120) + 'px';
            tower.appendChild(level);
            
            // Add enemies (2-4 per floor)
            const enemyCount = 2 + currentFloor;
            enemiesRemaining = enemyCount;
            
            for (let j = 0; j < enemyCount; j++) {
                const enemy = document.createElement('div');
                enemy.className = 'tower-enemy';
                enemy.textContent = ['👹', '💀', '👻', '🕷️', '🐍'][Math.floor(Math.random() * 5)];
                enemy.style.left = (20 + j * 80) + 'px';
                enemy.style.position = 'absolute';
                enemy.addEventListener('click', () => defeatEnemy(enemy));
                level.appendChild(enemy);
            }
            
            document.getElementById('currentFloor').textContent = currentFloor;
            document.getElementById('enemiesLeft').textContent = enemiesRemaining;
            
            // Move princess
            const princess = document.getElementById('princessWarrior');
            princess.style.bottom = ((currentFloor - 1) * 120 + 15) + 'px';
        }

        function startFloorTimer() {
            document.getElementById('floorTimer').textContent = floorTimeLeft;
            floorTimer = setInterval(() => {
                floorTimeLeft--;
                document.getElementById('floorTimer').textContent = floorTimeLeft;
                
                if (floorTimeLeft <= 0) {
                    // Add more enemies if time runs out
                    addMoreEnemies();
                    floorTimeLeft = 30;
                }
            }, 1000);
        }

        function addMoreEnemies() {
            const level = document.querySelector('.tower-level:last-child');
            if (level && enemiesRemaining > 0) {
                const enemy = document.createElement('div');
                enemy.className = 'tower-enemy';
                enemy.textContent = '👹';
                enemy.style.left = (Math.random() * 250) + 'px';
                enemy.style.position = 'absolute';
                enemy.addEventListener('click', () => defeatEnemy(enemy));
                level.appendChild(enemy);
                enemiesRemaining++;
                document.getElementById('enemiesLeft').textContent = enemiesRemaining;
            }
        }

        function defeatEnemy(enemy) {
            enemy.classList.add('defeated');
            enemiesRemaining--;
            document.getElementById('enemiesLeft').textContent = enemiesRemaining;
            
            if (enemiesRemaining <= 0) {
                clearInterval(floorTimer);
                currentFloor++;
                if (currentFloor > maxFloors) {
                    document.getElementById('towerResult').innerHTML = `
                        <div class="game-message">
                            🏰 TOWER CONQUERED! 🏰
                            <br><button class="btn" onclick="nextPage()">
                                🐉 FACE THE DRAGON
                            </button>
                        </div>
                    `;
                } else {
                    floorTimeLeft = 30;
                    setTimeout(() => setupFloor(), 1000);
                    setTimeout(() => startFloorTimer(), 1000);
                }
            }
        }

        // Game 3: Enhanced Dragon Battle (Much Easier!)
        function setupDragonGame() {
            dragonHealth = 5;
            dragonPhase = 1;
            princessHealth = 5;
            arrowHits = 0;
            
            const dragon = document.getElementById('dragonBoss');
            dragon.className = 'dragon-boss phase1';
            
            updateDragonStats();
            startDragonAttacks();
        }

        function shootMagicArrow() {
            const battlefield = document.getElementById('dragonBattlefield');
            const dragon = document.getElementById('dragonBoss');
            
            const arrow = document.createElement('div');
            arrow.className = 'magic-arrow';
            arrow.textContent = '⭐';
            arrow.style.left = '50px';
            arrow.style.bottom = '50px';
            battlefield.appendChild(arrow);
            
            // Much easier hit detection - 90% hit chance!
            setTimeout(() => {
                const dragonRect = dragon.getBoundingClientRect();
                const battlefieldRect = battlefield.getBoundingClientRect();
                const dragonVisible = dragonRect.left < battlefieldRect.right && dragonRect.right > battlefieldRect.left;
                
                if (dragonVisible && Math.random() < 0.9) { // 90% hit chance!
                    // Hit!
                    dragonHealth--;
                    arrowHits++;
                    dragon.classList.add('damaged');
                    setTimeout(() => dragon.classList.remove('damaged'), 400);
                    
                    // Phase transitions
                    if (dragonHealth <= 3 && dragonPhase === 1) {
                        dragonPhase = 2;
                        dragon.className = 'dragon-boss phase2';
                    } else if (dragonHealth <= 1 && dragonPhase === 2) {
                        dragonPhase = 3;
                        dragon.className = 'dragon-boss phase3';
                    }
                    
                    updateDragonStats();
                    
                    if (dragonHealth <= 0) {
                        dragonVictory();
                    }
                }
                
                if (battlefield.contains(arrow)) {
                    battlefield.removeChild(arrow);
                }
            }, 600);
        }

        function startDragonAttacks() {
            dragonAttackTimer = setInterval(() => {
                createDragonFire();
            }, 4000 - (dragonPhase * 500)); // Much slower attacks
        }

        function createDragonFire() {
            const battlefield = document.getElementById('dragonBattlefield');
            const fire = document.createElement('div');
            fire.className = 'dragon-fire';
            fire.textContent = '🔥';
            fire.style.right = '-50px';
            fire.style.top = (Math.random() * 150 + 150) + 'px'; // Fire at bottom area only
            battlefield.appendChild(fire);
            
            // Much more forgiving fire hit detection
            setTimeout(() => {
                const fireRect = fire.getBoundingClientRect();
                const princessRect = document.querySelector('.princess-archer').getBoundingClientRect();
                
                // Much smaller hit area - only direct hits count
                if (Math.random() < 0.3 && // Only 30% chance of hit even if overlapping
                    fireRect.left <= princessRect.right - 20 && fireRect.right >= princessRect.left + 20 &&
                    fireRect.top <= princessRect.bottom - 20 && fireRect.bottom >= princessRect.top + 20) {
                    // Princess hit!
                    princessHealth--;
                    document.querySelector('.princess-archer').classList.add('hit');
                    setTimeout(() => document.querySelector('.princess-archer').classList.remove('hit'), 500);
                    updateDragonStats();
                    
                    if (princessHealth <= 0) {
                        gameOver();
                    }
                }
                
                if (battlefield.contains(fire)) {
                    battlefield.removeChild(fire);
                }
            }, 2200); // Longer time before hit detection
        }

        function updateDragonStats() {
            document.getElementById('dragonHealth').textContent = dragonHealth;
            document.getElementById('dragonPhase').textContent = dragonPhase;
            document.getElementById('princessHealth').textContent = princessHealth;
            document.getElementById('arrowHits').textContent = arrowHits;
        }

        function dragonVictory() {
            clearInterval(dragonAttackTimer);
            document.getElementById('dragonResult').innerHTML = `
                <div class="game-message">
                    🎆 LEGENDARY VICTORY! 🎆
                    <br>Dragon defeated with ${arrowHits} hits!
                    <br><button class="btn" onclick="nextPage()" style="margin-top: 15px;">
                        👑 RESCUE THE PRINCE
                    </button>
                </div>
            `;
        }

        function gameOver() {
            clearInterval(dragonAttackTimer);
            document.getElementById('dragonResult').innerHTML = `
                <div class="game-message">
                    The dragon was fierce, but princesses never give up!
                    <br><button class="btn" onclick="setupDragonGame()" style="margin-top: 10px;">
                        🔄 TRY AGAIN
                    </button>
                </div>
            `;
        }

        // Dancing Animation with GSAP
        function startCelebrationAnimation() {
            showFinalTime();
            
            setTimeout(() => {
                document.getElementById('celebrationText').style.opacity = '0.3';
            }, 3000);
            
            // GSAP Animation
            if (typeof gsap !== 'undefined') {
                var master = gsap.timeline({repeat: -1}); 
                var couple = document.querySelector('#couple');
                var girl = document.querySelector('#girl');
                var boy = document.querySelector('#boy');
                var heart = document.querySelector('#heart');
                var ground = document.querySelector('#ground');
                var background = document.body;
                var light = document.querySelector('#triangle-light');

                master
                    .add(setup())
                    .add(darkness(), 'lightsOff+=1')
                    .add(girlKiss(), 'girlStuff+=0.2')
                    .add(boyStuff(), 'girlStuff+=2')
                    .add(heartStuff(), 'heartStuff-=1')
                    .add(lightsOn(), 'heartStuff+=1')
                    .add(backToStart(),'lightsOn+=1');

                function setup() {
                    var tl = gsap.timeline()
                        .set(couple, { autoAlpha: 1 })
                        .set(boy.querySelector('#boy-arm'), {  transformOrigin: '0% 10%', rotation: "+=40" })
                        .set(girl.querySelector('#girl-earring'), { scaleY: '0.7' })
                        .set(girl.querySelector('#girl-leg-1'), { rotation: '+=75' })
                        .set(girl.querySelector('#girl-arm'), { transformOrigin: '100% 0%', rotation: '-=60' })
                        .set(girl.querySelector('#girl-body'), { transformOrigin: '0% 75%', rotation: '+=20' })
                        .set(heart, { transformOrigin: '50% 50%', y: '+=100', scale: 0.5 });
                    return tl;
                }

                function darkness() {
                    var tl = gsap.timeline()
                        .to(background, { duration: 1, backgroundColor: '#241a22' })
                        .to(boy.querySelector('#boy-arm'), { duration: 0.5, rotation: 0 }, 1);
                    return tl;
                }

                function girlKiss() {
                    var tl = gsap.timeline()
                        .to(girl.querySelector('#girl-arm'), { duration: 1, rotation: 0 })
                        .to(girl.querySelector('#girl-body'), { duration: 0.5, transformOrigin: '0% 75%', rotation: 0 })
                        .to(girl.querySelector('#girl-eye'), { duration: 0.5, transformOrigin: '0% 50%', scaleY: 0.1 }, 1.25)
                        .to(girl.querySelector('#girl-leg-1'), { duration: 1.5, rotation: 0, ease: "back.out(3)" }, 1.25);
                    return tl;
                }

                function boyStuff() {
                    var tl = gsap.timeline()
                        .to(boy.querySelector('#boy-eye'), { duration: 0.5, transformOrigin: '0% 50%', scaleY: 0.1 });
                    return tl;
                }

                function heartStuff() {
                    var tl = gsap.timeline()
                        .to('#heart', { duration: 3, autoAlpha: 1, y: 0, scale: 1, ease: "elastic.out(1,0.3)" });
                    return tl;
                }

                function lightsOn() {
                    var tl = gsap.timeline()
                        .to(light, { duration: 0.25, autoAlpha: 1 }, 0)
                        .to(ground, { duration: 0.25, fill: '#F8E5C5' }, 0)  
                        .to(girl.querySelector('#girl-eye'), { duration: 0.5, scaleY: 1 }, 0.5)
                        .to(boy.querySelector('#boy-eye'), { duration: 0.5, scaleY: 1 }, 1)
                        .to(girl.querySelector('#girl-body'), { duration: 0.5, rotation: '+=20' })
                        .to(girl.querySelector('#girl-leg-1'), { duration: 1, rotation: '+=75' }, "-=0.75")
                        .to(girl.querySelector('#girl-arm'), { duration: 1, rotation: '-=60' }, "-=1.25")
                        .to('#heart', { duration: 1.5, autoAlpha: 0, scale: 0.5, y: -100, ease: "elastic.in(1,0.7)" }, "-=2")
                        .to(girl.querySelector('#girl-head'), { duration: 1, transformOrigin: "40% 50%", rotation: '-=30' }, "-=0.25")
                        .to(boy.querySelector('#boy-arm'), { duration: 1,  rotation: "+=40" });
                    return tl;
                }

                function backToStart() {
                    var tl = gsap.timeline()
                        .to(background, { duration: 1, backgroundColor: 'radial-gradient(circle at center, #1A1A2E 0%, #0F0F1A 100%)' })
                        .to(light, { duration: 0.5, autoAlpha: 0 }, '-=1')
                        .to(ground, { duration: 0.25, fill: '#5c5757' }, 0) 
                        .to(girl.querySelector('#girl-head'), { duration: 1, rotation: 0 }, "-=0.5");
                    return tl;
                }
            }
        }

        function showFinalTime() {
            const elapsed = Date.now() - gameStartTime;
            const minutes = Math.floor(elapsed / 60000);
            const seconds = Math.floor((elapsed % 60000) / 1000);
            document.getElementById('finalTime').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function createHeartEffect() {
            const container = document.getElementById('heartsContainer');
            const heart = document.createElement('div');
            heart.className = 'floating-heart';
            heart.textContent = ['💜', '💖', '❤️', '💕'][Math.floor(Math.random() * 4)];
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.top = '100vh';
            container.appendChild(heart);
            
            setTimeout(() => {
                if (heart.parentNode) heart.parentNode.removeChild(heart);
            }, 3000);
        }

        setInterval(createHeartEffect, 2000);

        function restartGame() {
            location.reload();
        }
    </script>
</body>
</html>
